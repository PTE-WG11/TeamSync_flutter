# TeamSync 用户旅程图文档

## 📋 文档信息
- **项目名称**: TeamSync 团队协作管理系统
- **版本**: v1.0
- **阶段**: Flutter Web端优先
- **日期**: 2026-02-10

---

## 1. 用户角色定义

| 角色 | 角色ID | 职责描述 | 系统权限 |
|------|--------|---------|---------|
| **超级管理员** | super_admin | 系统级管理，拥有所有权限 | 完全控制 |
| **团队管理员** | team_admin | 团队级管理，管理项目和成员 | 项目管理 + 成员管理 |
| **团队成员** | member | 普通成员，执行分配的任务 | 任务执行 + 子任务管理 |
| **访客** | visitor | 已注册但未加入团队的游客 | 仅等待页面 |

---

## 2. 用户旅程总览

```
┌────────────────────────────────────────────────────────────────────────────┐
│                         TeamSync 用户旅程地图                               │
├──────────┬──────────┬──────────┬──────────┬──────────┬─────────────────────┤
│   阶段    │  访客    │  新成员   │ 团队成员  │团队管理员 │   超级管理员         │
├──────────┼──────────┼──────────┼──────────┼──────────┼─────────────────────┤
│  认知期   │  注册    │ 接受邀请  │ 查看项目  │ 创建项目  │    系统配置          │
│          │ 登录     │ 完善信息  │ 查看任务  │ 分配任务  │    管理所有          │
├──────────┼──────────┼──────────┼──────────┼──────────┼─────────────────────┤
│  使用期   │ 等待页面 │ 查看任务  │ 执行任务  │ 跟踪进度  │    监控团队          │
│          │         │ 创建子任务 │ 更新状态  │ 管理成员  │    处理异常          │
├──────────┼──────────┼──────────┼──────────┼──────────┼─────────────────────┤
│  管理期   │   -     │    -     │ 查看统计  │ 查看报表  │    系统维护          │
│          │         │          │ 个人视图  │ 团队视图  │    数据归档          │
└──────────┴──────────┴──────────┴──────────┴──────────┴─────────────────────┘
```

---

## 3. 访客 (Visitor) 用户旅程

### 3.1 旅程概览

```
注册 ──► 登录 ──► 访客等待页 ──► 被邀请 ──► 成为成员
 │       │           │            │
 ▼       ▼           ▼            ▼
信息验证 Token获取   轮询检查      角色分配
```

### 3.2 详细旅程地图

| 阶段 | 触点 | 用户行为 | 系统响应 | 用户情绪 | 痛点 | 机会点 |
|------|------|---------|---------|---------|------|--------|
| **注册** | 注册页面 | 填写username、email、password | 验证唯一性，创建账号 | 😐 中性 | 等待验证 | 快速注册流程 |
| **登录** | 登录页面 | 输入凭证 | JWT Token颁发 | 😊 期待 | - | 记住登录状态 |
| **等待** | 访客页 | 查看等待提示 | 显示邀请状态 | 😟 焦虑 | 无法操作 | 提供联系管理员方式 |
| **检查** | 刷新按钮 | 点击检查状态 | 查询邀请状态 | 🤔 疑惑 | 需手动刷新 | WebSocket实时推送 |

### 3.3 访客等待页面流程

```
┌─────────────────────────────────────────┐
│           访客状态检查流程               │
├─────────────────────────────────────────┤
│                                         │
│   ┌──────────┐     无Token    ┌───────┐ │
│   │  进入系统  │──────────────►│ 登录页 │ │
│   └────┬─────┘               └───────┘ │
│        │ 有Token                       │
│        ▼                                │
│   ┌──────────┐     role=visitor ┌─────┐ │
│   │ 获取用户信息│────────────────►│等待页│ │
│   └────┬─────┘                  └──┬──┘ │
│        │ role=member/admin         │    │
│        ▼                           │    │
│   ┌──────────┐◄────────────────────┘    │
│   │ 正常首页  │ ◄── 被邀请后刷新/推送    │
│   └──────────┘                          │
│                                         │
└─────────────────────────────────────────┘
```

---

## 4. 团队成员 (Member) 用户旅程

### 4.1 旅程概览

```
登录 ──► 首页(任务卡片) ──► 项目列表 ──► 项目详情
 │           │               │            │
 ▼           ▼               ▼            ▼
通知查看   切换时间维度    选择项目    看板/甘特图/日历
           查看任务统计                查看/编辑任务
```

### 4.2 详细旅程地图 - 首页

| 阶段 | 触点 | 用户行为 | 系统响应 | 用户情绪 | 痛点 | 机会点 |
|------|------|---------|---------|---------|------|--------|
| **登录** | 登录页 | 输入凭证 | 验证并跳转首页 | 😊 期待 | - | 快速登录 |
| **概览** | 首页卡片 | 查看今日/本周/逾期统计 | 加载任务统计 | 😊 清晰 | 数据加载慢 | 骨架屏优化 |
| **切换** | 时间标签 | 切换时间维度 | 筛选任务列表 | 😊 方便 | - | 记住上次选择 |
| **查看** | 任务卡片 | 点击查看详情 | 打开任务详情页 | 😊 直观 | - | 快速编辑 |

### 4.3 详细旅程地图 - 项目视图

| 阶段 | 触点 | 用户行为 | 系统响应 | 用户情绪 | 痛点 | 机会点 |
|------|------|---------|---------|---------|------|--------|
| **进入** | 项目列表 | 点击项目 | 加载项目看板 | 😊 期待 | 项目太多 | 搜索/筛选 |
| **看板** | 看板视图 | 查看任务状态分布 | 按状态分组显示 | 😊 清晰 | - | 拖拽变更状态 |
| **甘特图** | 甘特图 | 查看时间轴 | 显示个人任务时间线 | 😊 直观 | 时间跨度大 | 缩放/滚动 |
| **日历** | 日历视图 | 查看日期分布 | 按日期分组 | 😊 方便 | - | 快速跳转 |

### 4.4 详细旅程地图 - 任务管理

| 阶段 | 触点 | 用户行为 | 系统响应 | 用户情绪 | 痛点 | 机会点 |
|------|------|---------|---------|---------|------|--------|
| **查看** | 任务详情 | 查看分配的任务 | 显示完整信息 | 😊 清晰 | - | 快速操作 |
| **子任务** | 任务树 | 展开子任务 | 加载层级结构 | 😊 方便 | 层级太深 | 折叠/展开 |
| **创建** | 创建按钮 | 创建子任务 | 验证层级限制 | 😊 可控 | 权限错误提示 | 清晰引导 |
| **更新** | 编辑表单 | 更新状态/时间 | 记录变更历史 | 😊 便捷 | - | 批量更新 |
| **附件** | 附件区 | 上传/查看附件 | MinIO预签名上传 | 😊 顺畅 | 大文件慢 | 进度条 |

### 4.5 成员任务操作流程

```
┌──────────────────────────────────────────────────────────────┐
│                    成员任务操作流程                           │
├──────────────────────────────────────────────────────────────┤
│                                                               │
│   ┌──────────┐                                               │
│   │  登录系统  │                                               │
│   └────┬─────┘                                               │
│        │                                                      │
│        ▼                                                      │
│   ┌──────────┐                                                │
│   │  首页仪表盘 │ ◄── 今日/本周/逾期任务统计                    │
│   │  任务卡片  │     快速了解工作负载                          │
│   └────┬─────┘                                               │
│        │                                                      │
│   ┌────┴──────────────┐                                       │
│   ▼                   ▼                                       │
│ ┌────────┐      ┌──────────┐                                 │
│ │查看项目 │      │查看通知  │                                 │
│ │ 列表   │      │  中心    │                                 │
│ └───┬────┘      └──────────┘                                 │
│     │                                                        │
│     ▼                                                        │
│ ┌──────────┐                                                 │
│ │ 选择项目  │                                                 │
│ └────┬─────┘                                                 │
│      │                                                        │
│ ┌────┴──────────┬──────────┬──────────┐                      │
│ ▼               ▼          ▼          ▼                      │
│ ┌────────┐  ┌────────┐ ┌────────┐ ┌────────┐                │
│ │看板视图 │  │甘特图  │ │日历视图│ │任务列表│                │
│ │(按状态)│  │(按时间)│ │(按日期)│ │(树形)  │                │
│ └───┬────┘  └───┬────┘ └────┬───┘ └───┬────┘                │
│     │           │           │         │                      │
│     └───────────┴─────┬─────┴─────────┘                      │
│                       ▼                                      │
│                 ┌──────────┐                                 │
│                 │ 任务详情  │ ◄── 可查看完整信息               │
│                 └────┬─────┘                                 │
│                      │                                        │
│         ┌────────────┼────────────┐                         │
│         ▼            ▼            ▼                         │
│    ┌────────┐  ┌────────┐  ┌────────┐                       │
│    │更新状态 │  │创建子任务│  │上传附件 │                      │
│    │(自己的)│  │(最多3层)│  │(预签名) │                      │
│    └────────┘  └────────┘  └────────┘                       │
│                                                               │
└──────────────────────────────────────────────────────────────┘
```

---

## 5. 团队管理员 (Team Admin) 用户旅程

### 5.1 旅程概览

```
登录 ──► 管理员首页 ──► 项目管理 ──► 成员管理 ──► 数据查看
 │          │             │            │            │
 ▼          ▼             ▼            ▼            ▼
系统概览   项目进度      创建项目     邀请成员     甘特图(全部)
项目统计   逾期提醒      分配任务     修改角色     看板(全部)
```

### 5.2 详细旅程地图 - 管理员首页

| 阶段 | 触点 | 用户行为 | 系统响应 | 用户情绪 | 痛点 | 机会点 |
|------|------|---------|---------|---------|------|--------|
| **概览** | 仪表盘 | 查看所有项目进度 | 加载项目统计 | 😊 掌控 | 项目太多 | 筛选/排序 |
| **进度** | 进度卡片 | 查看完成百分比 | 基于主任务计算 | 😊 清晰 | - | 趋势图表 |
| **预警** | 逾期提醒 | 查看逾期任务数 | 统计逾期任务 | 😟 关注 | 误报 | 智能提醒 |
| **快捷** | 创建按钮 | 快速创建项目 | 打开创建弹窗 | 😊 高效 | - | 模板选择 |

### 5.3 详细旅程地图 - 项目管理

| 阶段 | 触点 | 用户行为 | 系统响应 | 用户情绪 | 痛点 | 机会点 |
|------|------|---------|---------|---------|------|--------|
| **创建** | 创建表单 | 填写项目信息+分配成员 | 创建项目及初始任务 | 😊 便捷 | 成员选择 | 成员搜索 |
| **查看** | 项目列表 | 查看所有项目 | 加载项目列表 | 😊 清晰 | 归档项目干扰 | 状态筛选 |
| **详情** | 项目卡片 | 点击进入详情 | 加载看板视图 | 😊 直观 | - | 默认视图记忆 |
| **归档** | 归档按钮 | 归档已完成项目 | 软删除标记 | 😊 安全 | 误操作 | 二次确认 |

### 5.4 详细旅程地图 - 成员管理

| 阶段 | 触点 | 用户行为 | 系统响应 | 用户情绪 | 痛点 | 机会点 |
|------|------|---------|---------|---------|------|--------|
| **查看** | 成员列表 | 查看团队成员 | 加载成员信息 | 😊 清晰 | - | 角色筛选 |
| **邀请** | 邀请表单 | 输入username邀请 | 发送邀请通知 | 😊 方便 | 用户不存在 | 实时检查 |
| **修改** | 角色下拉 | 修改成员角色 | 更新权限 | 😊 灵活 | - | 权限预览 |
| **移除** | 移除按钮 | 从团队移除成员 | 解除关联 | 😟 谨慎 | 误操作 | 二次确认 |

### 5.5 详细旅程地图 - 任务分配

| 阶段 | 触点 | 用户行为 | 系统响应 | 用户情绪 | 痛点 | 机会点 |
|------|------|---------|---------|---------|------|--------|
| **创建** | 任务表单 | 创建主任务 | 分配负责人 | 😊 明确 | 重复创建 | 模板复用 |
| **分配** | 负责人选择 | 选择任务负责人 | 发送分配通知 | 😊 高效 | 负载不均 | 工作量提示 |
| **跟踪** | 甘特图 | 查看所有任务时间线 | 加载甘特图数据 | 😊 全局观 | 任务太多 | 筛选/折叠 |
| **调整** | 编辑表单 | 调整任务时间/负责人 | 记录变更历史 | 😊 灵活 | 影响子任务 | 影响提示 |

### 5.6 管理员操作流程

```
┌──────────────────────────────────────────────────────────────────────┐
│                      团队管理员操作流程                               │
├──────────────────────────────────────────────────────────────────────┤
│                                                                       │
│   ┌──────────┐                                                       │
│   │  登录系统  │                                                       │
│   └────┬─────┘                                                       │
│        │                                                              │
│        ▼                                                              │
│   ┌──────────────┐                                                    │
│   │  管理员仪表盘  │ ◄── 项目进度概览 / 逾期预警 / 快捷入口              │
│   └──────┬───────┘                                                    │
│          │                                                            │
│    ┌─────┴─────┬──────────┐                                           │
│    ▼           ▼          ▼                                           │
│ ┌────────┐ ┌────────┐ ┌────────┐                                     │
│ │项目管理 │ │成员管理 │ │  数据   │                                     │
│ └────┬───┘ └───┬────┘ └───┬────┘                                     │
│      │         │          │                                           │
│      ▼         ▼          ▼                                           │
│ ┌─────────┐ ┌─────────┐ ┌─────────────┐                              │
│ │创建项目 │ │查看成员 │ │看板(全部任务)│                              │
│ │分配任务 │ │邀请成员 │ ├─────────────┤                              │
│ │编辑项目 │ │修改角色 │ │甘特图(全部)  │                              │
│ │归档项目 │ │移除成员 │ ├─────────────┤                              │
│ │删除项目 │ └─────────┘ │成员工作量   │                              │
│ └─────────┘             └─────────────┘                              │
│                                                                       │
│  关键操作:                                                            │
│  ─────────────────────────────────                                   │
│  1. 创建项目时必须至少分配1个成员                                      │
│  2. 只能创建主任务(Level=1)，分配给团队成员                            │
│  3. 可查看所有任务的详情（包括成员创建的子任务）                        │
│  4. 可查看所有成员的甘特图                                             │
│  5. 可管理团队成员的角色                                               │
│                                                                       │
└──────────────────────────────────────────────────────────────────────┘
```

---

## 6. 超级管理员 (Super Admin) 用户旅程

### 6.1 旅程概览

超级管理员拥有所有权限，其旅程是团队管理员的超集。

```
登录 ──► 系统管理首页 ──► 全局管理
 │            │              │
 ▼            ▼              ▼
所有项目    所有团队        系统设置
所有成员    数据统计        日志审计
```

### 6.2 专属功能

| 功能 | 说明 | 场景 |
|------|------|------|
| 硬删除项目 | 物理删除已归档项目 | 清理测试数据 |
| 系统配置 | 全局参数设置 | 系统维护 |
| 日志查看 | 操作审计日志 | 安全审计 |
| 跨团队管理 | 管理所有团队 | 系统级管理 |

---

## 7. 核心流程时序图

### 7.1 任务分配与执行流程

```
┌─────────┐    ┌─────────┐    ┌─────────┐    ┌─────────┐    ┌─────────┐
│  Admin  │    │  System │    │  Member │    │  DB     │    │ WebSocket│
└────┬────┘    └────┬────┘    └────┬────┘    └────┬────┘    └────┬────┘
     │              │              │              │              │
     │ 创建主任务    │              │              │              │
     │─────────────►│              │              │              │
     │              │ 保存任务     │              │              │
     │              │─────────────►│              │              │
     │              │              │ 分配通知     │              │
     │              │────────────────────────────►│              │
     │              │              │              │              │
     │              │              │ 查看任务     │              │
     │              │◄────────────────────────────│              │
     │              │              │              │              │
     │              │              │ 创建子任务   │              │
     │              │◄────────────────────────────│              │
     │              │ 验证层级     │              │              │
     │              │─────────────►│              │              │
     │              │ 保存子任务   │              │              │
     │              │─────────────►│              │              │
     │              │              │              │              │
     │              │              │ 更新状态     │              │
     │              │◄────────────────────────────│              │
     │              │ 记录历史     │              │              │
     │              │─────────────►│              │              │
     │              │              │ 推送变更     │              │
     │              │────────────────────────────────────────────►│
     │              │              │              │              │
```

### 7.2 通知推送流程

```
┌─────────┐    ┌─────────┐    ┌─────────┐    ┌─────────┐
│  User   │    │  System │    │   DB    │    │   WS    │
└────┬────┘    └────┬────┘    └────┬────┘    └────┬────┘
     │              │              │              │
     │  操作触发    │              │              │
     │─────────────►│ 生成通知     │              │
     │              │─────────────►│              │
     │              │ 保存通知     │              │
     │              │◄─────────────│              │
     │              │              │              │
     │              │ WebSocket推送 │              │
     │◄───────────────────────────────────────────│
     │              │              │              │
     │ 查看通知列表 │              │              │
     │─────────────►│              │              │
     │              │ 查询通知     │              │
     │              │─────────────►│              │
     │              │◄─────────────│              │
     │◄─────────────│              │              │
     │              │              │              │
     │ 标记已读     │              │              │
     │─────────────►│ 更新状态     │              │
     │              │─────────────►│              │
     │              │              │              │
```

---

## 8. 异常流程处理

### 8.1 权限不足

```
用户操作 ──► 权限检查 ──► 权限不足 ──► 显示脱敏数据/提示
                              │
                              ▼
                         记录审计日志
```

### 8.2 邀请用户不存在

```
Admin邀请 ──► 输入username ──► 用户不存在 ──► 显示错误提示
                                      │
                                      ▼
                                 建议检查用户名
```

### 8.3 任务层级超限

```
创建子任务 ──► 检查父级level ──► level >= 3 ──► 拒绝创建
                                            │
                                            ▼
                                       提示最大3层
```

---

## 9. 用户体验设计要点

### 9.1 界面一致性

| 元素 | 设计规范 |
|------|---------|
| **主色调** | #0D9488 (Teal 600) |
| **背景色** | #F8FAFC (Slate 50) |
| **成功状态** | #10B981 (Emerald 500) |
| **警告状态** | #F59E0B (Amber 500) |
| **错误状态** | #F43F5E (Rose 500) |

### 9.2 交互反馈

| 场景 | 反馈方式 |
|------|---------|
| 操作成功 | Toast提示 + 状态更新 |
| 操作失败 | 错误提示 + 原因说明 |
| 加载中 | 骨架屏 + 加载动画 |
| 无数据 | 空状态插画 + 引导操作 |
| 权限不足 | 脱敏显示 + 提示信息 |

### 9.3 无障碍设计

- 支持键盘导航
- 提供足够的颜色对比度
- 图标配合文字说明
- 错误信息清晰明确

---

*文档版本: v1.0 | 最后更新: 2026-02-10*
